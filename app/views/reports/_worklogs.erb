<% unless @users.empty? %>
    <div class="export-options">
      <%= link_to "PDF", current_url(:format => :pdf), :target => "_blank" %>
      <%= link_to "CSV", current_url(:format => :csv), :target => "_blank" %>
      <%= link_to "Excel", current_url(:format => :xls), :target => "_blank" %> |
      <%= link_to "Detailed report", current_url(:format => :xls,:detailed=>true), :target => "_blank" %>
    </div>
    <div class="report">

      <table class="table sortable-table">
        <thead>
        <tr>
          <th width="3000" class="name">Name</th>
          <% (@start_date..@end_date).each do |dt| %>
              <th width="50" class="log">
                <%= dt.day %>
              </th>
          <% end %>
          <th class="calcd">Average</th>
          <th class="calcd">Total</th>
        </tr>
        </thead>

        <tbody>
        <% @users.each do |user| %>
            <tr>
              <td class="name">
                <%= user.name %>
              </td>
              <% (@start_date..@end_date).each do |dt| %>
                  <td class="log" title='<%= "#{user.name},#{dt.strftime('%d/%m/%y')}" %>'>
                    <% unless @hours[user.id][dt.day].blank? %>
                        <%= link_to @hours[user.id][dt.day].to_duration, reports_day_log_path(:date => dt, :user_id => user), :remote => true %>
                    <% else %>
                        -
                    <% end %>
                  </td>
              <% end %>
              <td class="calcd"><%= @average[user.id] %></td>
              <td class="calcd"><%= @total[user.id].to_duration %></td>
            </tr>
        <% end %>
        </tbody>
      </table>
    </div>
<% else %>
    <div class="alert-box secondary">
      No users to show.
    </div>
<% end %>
<script type="text/javascript">
    $(".sortable-table").tablesorter();
</script>
